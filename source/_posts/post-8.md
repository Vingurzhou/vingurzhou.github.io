---
title: 《线性反馈移位寄存器(LFSR)加扰》
date: 2025-03-22
tags:
    - lfsr
    - 对称加扰
category: article
author: 周文喆
toc: true
---
上级丢了个多项式让我对遥测指令进行加扰
<!--more-->

## 什么是数据加扰

数据加扰（Data Scrambling）是一种数据保护技术，通过对原始数据进行变换或混淆，使其难以被直接理解或识别，同时保留数据的某些特性（如格式或统计分布），以便在测试、开发或分析环境中安全使用。它常用于保护敏感信息，如个人身份数据、财务信息等，避免在非生产环境中泄露。

主要特点：

- **目的**：防止未经授权的访问者理解数据。
- **方法**：包括加密、替换、随机化、掩码等技术。例如，将真实姓名替换为随机生成的姓名，或对数字进行数学变换。
- **应用场景**：数据库测试、软件开发、数据共享、隐私保护。
- **优势**：在保护隐私的同时，保持数据的可用性（如格式一致性）。
- **局限性**：加扰后的数据可能仍需特定规则还原，且不适合所有场景（如需要精确数据的分析）。

与加密不同，加扰通常不强调可逆性，重点是数据混淆而非安全存储。

## 什么是LFSR

LFSR（线性反馈移位寄存器，Linear Feedback Shift Register）是一种用于生成伪随机序列的数字电路结构。它由一组移位寄存器组成，通过特定的反馈函数（通常是异或运算）将其输出位与某些寄存器的位组合后反馈到输入端。LFSR广泛应用于通信、密码学、测试和信号处理等领域。

### 工作原理

1. **结构**：LFSR包含一个n位的移位寄存器，每个寄存器存储一个二进制位（0或1）。
2. **反馈**：通过一个反馈多项式（也叫特征多项式），选择某些寄存器的位进行异或运算，生成反馈位。
3. **移位**：每经过一个时钟周期，寄存器中的位向右（或左）移动一位，最低位（或最高位）输出，新的反馈位输入到最高位（或最低位）。
4. **多项式**：反馈多项式通常表示为 \( f(x) = x^n + c_{n-1}x^{n-1} + \dots + c_1x + 1 \)，其中 \( c_i \) 表示是否选择第i位进行反馈（1为选择，0为不选择）。

### 特性

- **周期**：LFSR生成的序列是周期性的，最大周期为 \( 2^n - 1 \)（当反馈多项式为本原多项式时，排除全0状态）。
- **伪随机性**：生成的序列看似随机，但实际上是确定性的，适合需要可重复随机序列的场景。
- **简单高效**：硬件实现简单，计算速度快。

### 应用

1. **伪随机数生成**：用于模拟、测试和密码学。
2. **错误检测与纠正**：如循环冗余校验（CRC）。
3. **通信系统**：用于信号调制、扩频通信（如CDMA）。
4. **密码学**：作为流密码的组成部分（如A5/1算法）。

### 举例

假设一个4位LFSR，反馈多项式为 \( f(x) = x^4 + x^3 + 1 \)，初始状态为1011：

1. 寄存器状态：1011
2. 反馈位：第4位（1）异或第3位（0）= 1
3. 移位后：1101（输出最低位1，输入反馈位1）
4. 重复此过程，生成序列：1, 1, 0, 1, 0, ...

若多项式为本原多项式，序列周期可达 \( 2^4 - 1 = 15 \)。

## 最终逻辑实现→[GitHub](<https://github.com/Vingurzhou/pkg/blob/main/satellite/cmd.go>)
